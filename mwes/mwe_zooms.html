<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <!-- d3-->
  <script src="http://localhost:8000/src/dependencies/d3/d3.js" charset="utf-8"></script>  

  <!-- d3-xyzoom-->
  <script src="http://localhost:8000/src/dependencies/d3-xyzoom/build/d3-xyzoom.js"></script>

  <!-- Load data from json-->
  <script src="data/path_data_plotmwe.json" charset="utf-8"></script>

  <!-- Math symbols PUT AS LAST IMPORT!-->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_SVG">
  </script>  

</head>

<style>
</style>

<body>
  <script type="module">

    import {Canvas} from '../../src/functions/Canvas.js'
    import {NQBGColors,NQColors,NQTextColors,NQFonts} from '../../src/variables/NQ_colors_and_fonts.js'
    import {Svg} from '../src/classes/Svg.js'
    import {Plot} from '../src/classes/Plot.js'
    import {AddMathJax} from '../../src/functions/AddMathJax.js'

    if (document.URL.includes('template_hh')){
      window.currentTime = 0
      performance.now = () => currentTime
    }

    let timing = 0

    /*********************************
    Auxiliaries
    *********************************/  
    function getRandomIntInclusive(dd, seed) {
      let min = Math.ceil(dd[0])
      let max = Math.floor(dd[1])
      return Math.floor(Math.random(seed) * (max - min + 1)) + min //The maximum is inclusive and the minimum is inclusive 
    }
    function CreateScatterData(d){
        let scatterData = []
        for (let i=1;i<=30;i++) {
          scatterData.push({"x": getRandomIntInclusive(d.x, i),  "y": getRandomIntInclusive(d.y, i), "color": NQColors.orange, "r": 10})
        }
        return scatterData  
    }

    /*********************************
    Define objects 
    *********************************/
    // Backgorund svg
    const svg = Canvas({})
    
    let svg1params = {
         "id"          : "svg1"
        ,"pos"         : [[150, 100]]
        ,"dim"         : [2300, 1090]     
        ,"strokeColor" : "red"
        ,"strokeWidth" : 0
    }
    let svg1 = new Svg(svg1params)
    svg1.Draw({delay:0, duration:0})
    
    //// line plot
    //let params1 = {
    //   "pos"                : [[0,0]]
    //  ,"xRange"             : [0,1400]
    //  ,"yRange"             : [0,770]
    //  ,"yDomain"            : [0,10]
    //  ,"xDomain"            : [0,9]
    //  ,"id"                 : "plot1"
    //  ,"yLabel"             : "$\\alpha + \\text{Time}$"
    //  ,"yLabelSize"         : 30
    //  ,"xLabel"             : "dd"
    //  ,"svgid"              :"svg1"
    //}
    //let plot1 = new Plot(params1)
    //let lineDataParams1 = {
    //     "data"        : lineDataObject["y1"]
    //    ,"id"          : "linedata1"         
    //    ,"strokeWidth" : 3
    //    ,"strokeColor" : NQColors.orange
    //    ,"drawEase"    : d3.easeCubic
    //}
    //let lineDataParams1_copy = {
    //     "data"        : lineDataObject["y1"]
    //    ,"id"          : "linedata1_copy"         
    //    ,"strokeWidth" : 3
    //    ,"strokeColor" : NQColors.yellow
    //    ,"drawEase"    : d3.easeCubic
    //}    
    //let lineDataParams2 = {
    //     "data"        : lineDataObject["y3"]
    //    ,"id"          : "linedata2"
    //    ,"strokeWidth" : 3
    //    ,"strokeColor" : NQColors.orange
    //    ,"drawEase"    : d3.easeCubic
    //}

    // Scatter + line plot
    let paramsScatter1 = {
       "data"        : CreateScatterData({'x':[-9,19], 'y':[-8,8]})
      ,"id"          : "scatter1"
      ,"strokeWidth" : 4
    }
    let lineDataParams3 = {
         "data"        : lineDataObject["y1"]
        ,"id"          : "linedata3"         
        ,"strokeWidth" : 3
        ,"strokeColor" : NQColors.orange
        ,"drawEase"    : d3.easeCubic
    }    
    let params2 = {
       "pos"                : [[100,100]]
      ,"xRange"             : [0,1400]
      ,"yRange"             : [0,770]
      ,"yDomain"            : [-10,10]      
      ,"xDomain"            : [-10,20]
      ,"id"                 : "plot2"
      ,"yLabel"             : "$\\alpha + \\text{Time}$"
      ,"yLabelSize"         : 30
      ,"xLabel"             : "dd"      
    }
    let plot2 = new Plot(params2)

    /*********************************
    Animate - Zoom out line chart and continue drawing the line
    Notice that line is drawn on  svg1 that originally extends
    over background svg.
    *********************************/
    /*
    // Plot axes to svg1, plot line to axes  
    timing = timing + 1000
    plot1.Draw({delay:timing, duration:300})
    plot1.DrawLine({delay:timing+300, duration:500, plotObjParams:lineDataParams1})

    // Zoom out svg1 and continue x axis
    timing = timing + 1000
    svg1.Update({
      delay:timing,
      duration:1500,
      params:{
        newScale : 0.5
      }
    })
    let params1_a = {'xDomain': [0, 16], 'xRange': [0, 2300]}
    plot1.MoveLine({delay:timing, duration:2000, plotObjParams:lineDataParams1, plotParams:params1_a})
    
    // Continue line
    timing = timing + 2500
    plot1.DrawLine({delay:timing, duration:1500, plotObjParams:lineDataParams2})

    timing = timing + 2000
    let params1_b = {'xDomain': [0, 12]}
    plot1.MoveLine({delay:timing, duration:1000, plotObjParams:[lineDataParams1,lineDataParams2], plotParams:params1_b})

    timing = timing + 2000
    plot1.Hide({delay:timing, duration:300})    
    //*/

    /*********************************
    Animate - Zoom in scatter chart
    *********************************/
    ///*
    timing = timing + 0
    plot2.Draw({delay:timing, duration:0})
    plot2.DrawScatter({delay:0, duration:0, plotObjParams:paramsScatter1})    
    plot2.DrawLine({delay:timing, duration:500, plotObjParams:lineDataParams3})


    timing = timing + 1500
    let zoomparams = {
       "yDomain"    : [5,9]
      ,"xDomain"    : [-10,-8]
      ,"zoomEase"   : d3.easeCubic
    }    
    plot2.Zoom({delay:timing, duration:2000, zoomParams:zoomparams})

    timing = timing + 3000
    plot2.Zoom({delay:timing, duration:2000, zoomParams:{"type":"reset"}})
 

    //timing = timing + 1500
    //let newAxisParams = {"yDomain": [3,9], "xDomain": [0,11]} 
    //plot2.MoveScatter({delay:timing, duration:1000, plotObjParams:paramsScatter1, plotParams:newAxisParams})
    //*/

    //timing = timing + 1500    
		//d3.timeout(() => {




		//}, timing)	





    // This needs to be added in conjunction with the import above!
    AddMathJax(svg)

  </script> 

</body>
</html>